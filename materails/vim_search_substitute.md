
# Vim 搜索和替换

## 一、搜索 /

**语法：**

    /regex

| Character | Function |
|-|-|
| `\<` |  匹配单词词首 |
| `\>` |  匹配单词词尾 |
| `^`  |  匹配行首 |
| `$`  |  匹配行尾 |
| | |
| `*`  |  量词，匹配零个或多个 |
| `\+` |  量词，匹配一个或多个 |
| `\?` |  量词，匹配零个或一个 |
| | |
| `.`  |  匹配任意字符 |
| `\.` |  匹配 `.` |
| `\*` |  匹配 `*` |
| `\/` |  匹配 `/` |
| `\\` |  匹配 `\` |
| `\[` |  匹配 `[` |

## 二、替换 :/

**语法：**

    :s/regex/replacement/[options]


- `s` 表示替换。
- `g` 表示当前行所有匹配项。没有此选项时只替换第一个匹配项。
- `c` 表示替换前要确认。

**替换 0 - 490 行所有单词两边的单引号为反引号：**

    0,490s/'\(\w*\)'/`1`/gc

- 可匹配 'a'，'a_3'，'' 等。
- `\w` 等于 `[0-9A-Za-z_]`

**替换整个文档中所有单词两边的双引号为反引号：**

    %s/"\(\w*\)"/`1`/gc

**其他**

    %s/"\(\S*\)"/`1`/gc

- 可匹配 "C-R" 等。

**分组**

使用 `\(` 和 `\)` 符号括起正规表达式，即可在后面使用 `\1`、`\2` 等变量来访问。

查找开头和结尾处a的个数相同的字符串，如 `aabbbaa`，`aaacccaaa`：

    /\(a\+\)[^a]\+\1


## 三、与 Perl 正则表达式的区别


| Vim语法      | Perl语法   | 含义     |
| - | - | - |
| `\+`         | `+`        | 1-任意个 |
| `\?`         | `?`        | 0-1个    |
| `\{n,m}`     | `{n,m}`    | n-m个    |
| `\(` 和 `\)` | `(` 和 `)` | 分组     |


## 四、练习

**替换当前行第一个 vivian 为 sky**

    :s/vivian/sky/ 

**替换当前行所有 vivian 为 sky**

    :s/vivian/sky/g

**替换第 n 行开始到最后一行中每一行的第一个 vivian 为 sky**

    :n,$s/vivian/sky/ 

**替换第 n 行开始到最后一行中每一行所有 vivian 为 sky**

    :n,$s/vivian/sky/g 

>若 n 为点 `.`，表示从当前行开始到最后一行。 

**替换整个文档每一行的第一个 vivian 为 sky**

    :%s/vivian/sky/

**替换整个文档每一行中所有 vivian 为 sky**

    :%s/vivian/sky/g 

>可以使用 `#` 作为分隔符，此时中间出现的 `/` 不会作为分隔符。

**替换当前行第一个 vivian/ 为 sky/**

    :s#vivian/#sky/# 

**使用 + 来替换 /，将/oradata/apras/ 替换成 /user01/apras1/**

    :%s+/oradata/apras/+/user01/apras1+
